"use strict";!function(a){function b(b,d){function e(a){k.text(a)}function g(a){i||(!0===a.done&&h(!0,""),l&&e("Generating Support Files: "+a.message))}function h(a,b){i=!0,l&&(a?c.unblockUI({message:"Generating Support Files: "+b.numberComponentsDeployed+" deployed, "+b.numberComponentErrors+" errors",timeout:3e3}):(f.isString(b)||(b=b&&b.statusText||""),c.blockUI({message:"There was an error: "+b,timeout:5e3})))}d||(d={});var i=!1,j=f.generateUniqueId(),k=c("<div>").attr("id",j),l=!0!==d.quiet;return l&&(c.blockUI({message:k}),e("Generating Support Files for "+b.length+" Page(s): Initiating Deployment"),d.progressCallback=g),a.pageSupport.generateFiles(b,d).then(function(a){h(!0,a)},function(a){h(!1,a)})}var c=a.$,d=a.snippet,e=d.register,f=a.utils,g=a.constants.SALESFORCE,h=f.capitalizeFirst,i=a.dataSource,j=function(b){var d=b.field,e=b.value,f=b.entries,g=b.onChange;"edit"===d.mode?d.element.html(a.ui.renderers.PICKLIST.edit({value:e,required:!0,onChange:function(a){d.model.updateRow(d.row,d.id,a,{initiatorId:d._GUID}),g&&b.onChange(a)},entries:f})):(c.each(f,function(){if(e===this.value)return e=this.label,!1}),a.ui.getFieldRenderer(d.metadata.displaytype)[d.mode](d,e))},k=function(){var a={};return c.each(i.map(),function(b,c){var d=c.dataSourceType?c.dataSourceType.name:c.dataSourceTypeName;d&&(a[d]||(a[d]=[]),a[d].push(c))}),a};e("skuid.core.haveMultipleActiveDataSources",function(){return f.size(a.dataSource.map())>1}),e("skuid.core.actions.previewPage",function(){var a=arguments[0],b=d.get("skuid.builder.page.preview");b&&b({model:a.model,row:a.item?a.item.row:a.row})}),e("skuid.core.renderers.dataSourceType",function(){j({field:arguments[0],value:f.decodeHTML(arguments[1]),entries:c.map(k(),function(a,b){if("REST"!==b&&"Ui-Only"!==b)return{value:b,label:b}}).sort(function(a,b){return a.value===g?-1:h(a.label)>h(b.label)})})}),e("skuid.core.renderers.dataSource",function(){var a=k(),b=arguments[0],d=b.model.getFieldValue(b.row,"skuid__DataSourceType__ui",!0)||Object.keys(a)[0];j({field:arguments[0],value:f.decodeHTML(arguments[1]),entries:c.map(a[d],function(a){var b=a.name;return{value:b,label:b===g?"Current Salesforce Org":b}}).sort(function(a,b){return a.value===g?-1:h(a.label)>h(b.label)})})}),e("skuid.core.snippets.newPageRenderStartingPoint",function(a){var b,d,e=a.updates&&a.updates.skuid__Type__c,f=a.model,g=a.row;e&&(b=f.getFieldValue(g,"skuid__Initial_State__c"),d=f.registeredFields,"Mobile"===e&&"masterpage"===b&&f.updateRow(g,{skuid__Initial_State__c:"none"}),c.each(d,function(){"skuid__Initial_State__c"===this.id&&this.render()}))}),e("skuid.core.snippets.newPageStartingPoint",function(b,d){if(b.options||(b.options={}),b.options.type="RADIO_BUTTONS",a.ui.getFieldRenderer(b.metadata.displaytype)[b.mode](b,d),b.options.type="CUSTOM","edit"===b.mode){var e=b.model,f=b.row;if("Mobile"===e.getFieldValue(f,"skuid__Type__c")){b.element.find("div.nx-radiowrapper").each(function(){var a=c(this);"masterpage"===a.children('input[type="radio"]').val()&&a.hide()})}}}),e("skuid.settings.snippets.regenSupportFiles",function(){var d=a.$M("stng__AllPages");return c.blockUI({message:"Querying Skuid Pages..."}),d.updateData().then(function(){return b(d.getRows())})}),e("skuid.pageList.snippets.regenSupportFiles",function(a){return b(a.list.getSelectedItems())}),e("skuid.pageList.snippets.regenPackSupportFiles",function(a){return b(a)}),e("skuid.pageBuilder.snippets.regenSupportFile",function(a){return b(a.model.getRows(),{relaxFieldChecks:!0})}),e("skuid.pageBuilder.snippets.regenSupportFileQuietly",function(a){return b(a.model.getRows(),{relaxFieldChecks:!0,quiet:!0})}),c(document.body).one("pageload",function(){var b=a.$M("pgs__NewPage"),d='<skuidpage unsavedchangeswarning="yes" personalizationmode="server" useviewportmeta="true"';e("PrimaryObjectField",function(b){var c=b.model,d=b.row,e=k(),f=c.getFieldValue(d,"skuid__Primary_Object__c",!0);b.element.append(a.ui.renderers.ENTITY.edit({value:f,dataSource:function(){var b=c.getFieldValue(d,"skuid__DataSourceType__ui",!0)||Object.keys(e)[0],f=c.getFieldValue(d,"skuid__DataSource__ui",!0);return f&&a.dataSource.getDataSource(f)||e[b][0]},onChange:function(a){c.updateRow(d,"skuid__Primary_Object__c",a,{initiatorId:b._GUID})}}))});var h=function(b){b||(b={});var e,h,i,j,k=b.model,l=b.row,m=k.getFieldValue(l,"skuid__Initial_State__c",!0)||"none",n=k.getFieldValue(l,"skuid__Page_Template__c",!0)||"tab-page",o=k.getFieldValue(l,"skuid__Primary_Object__c",!0)||"",p=k.getFieldValue(l,"skuid__DataSourceType__ui",!0)||g,q=k.getFieldValue(l,"skuid__DataSource__ui",!0)||g,r=a.dataSource.getDataSource(q),s=r.getCachedEntityMetadata(o),t=q===g&&p===g,u=k.getFieldValue(l,"skuid__Type__c",!0)||"Desktop",v=function(){p===g&&c.inArray(o,["Contact","Lead","User"])>-1?(i=["FirstName","LastName"],"Lead"===o&&i.push("Company")):(i=[],(j=r.getNameField(o))&&i.push(j))};if(""!==o&&"none"!==m)h=o.replace("__c","").replace(/_/g,""),"tab-page"===n?(v(),e="Mobile"===u?d+"><models>":d+' showsidebar="true" showheader="true" '+(t?'tabtooverride="'+o+'"':"")+"><models>",e+='<model id="'+h+'" limit="100" query="true" createrowifnonefound="false" datasourcetype="'+p+'" datasource="'+q+'" sobject="'+o+'">',e+="<fields>",c.each(i,function(a,b){s.getField(b)&&(e+='<field id="'+b+'"/>')}),s.getField("CreatedDate")&&(e+='<field id="CreatedDate"/>'),e+="</fields>",e+="<conditions/></model></models><components>","Desktop"===u?(e+='<pagetitle model="'+h+'"><maintitle><template>{{Model.labelPlural}}</template></maintitle><subtitle><template>Home</template></subtitle><actions><action type="savecancel"/></actions></pagetitle>',e+='<skootable showconditions="true" showsavecancel="false" searchmethod="server" searchbox="true" showexportbuttons="false" pagesize="10"  createrecords="true" model="'+h+'" mode="read" allowcolumnreordering="true"><fields>',c.each(i,function(a,b){s.getField(b)&&(e+='<field id="'+b+'" hideable="true" allowordering="true" uniqueid="'+f.generateUniqueId({prefix:"fi"})+'"/>')}),s.getField("CreatedDate")&&(e+='<field id="CreatedDate" hideable="true" allowordering="true" uniqueid="'+f.generateUniqueId({prefix:"fi"})+'"/>'),e+='</fields><rowactions><action type="edit"/><action type="delete"/></rowactions><massactions usefirstitemasdefault="true"><action type="massupdate"/><action type="massdelete"/></massactions><views><view type="standard"/></views></skootable>'):"Mobile"===u&&(e+="<skuidmobile>",e+="<mobilepanels>",e+='<mobilepanel uniqueid="main" minwidth="400">',e+="<components>",e+='<mobiledeck showsavecancel="true" searchmethod="server" searchbox="true" tokenizesearch="true" createrecords="true" precision="6" minwidth="300" model="'+h+'" mode="read">',e+="<components>",c.each(i,function(a,b){s.getField(b)&&(e+='<mobilefield id="'+b+'"/>')}),s.getField("CreatedDate")&&(e+='<mobilefield id="CreatedDate"/>'),e+="</components>",e+="<title>{{Model.labelPlural}}</title>",e+="<cardtitle>",c.each(i,function(a,b){e+=(0!==a?" ":"")+"{{"+b+"}}"}),e+="</cardtitle>",e+="</mobiledeck>",e+="</components>",e+="</mobilepanel>",e+="</mobilepanels>",e+="<mobilenavs>",e+='<mobilenav uniqueid="header">',e+="<components>",e+='<mobilegrid precision="6" minwidth="50">',e+="<divisions>",e+='<division size="1">',e+="<components>",e+='<mobilebutton label="" style="nav" icon="fa-bars">',e+="<actions>",e+='<action type="setMainPanel" panel="main"/>',e+="</actions>",e+="</mobilebutton>",e+="</components>",e+="</division>",e+='<division size="4">',e+="<components>",e+="<mobiletitle>",e+="<contents>{{$Model."+h+".labelPlural}}</contents>",e+="</mobiletitle>",e+="</components>",e+="</division>",e+='<division size="1">',e+="<components>",e+='<mobilebutton label="" style="nav" icon="fa-th">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</mobilebutton>",e+="</components>",e+="</division>",e+="</divisions>",e+="</mobilegrid>",e+="</components>",e+="<interactions>",e+='<interaction type="doubletap">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</interaction>",e+='<interaction type="swipedown">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</interaction>",e+="</interactions>",e+="</mobilenav>",e+="</mobilenavs>",e+="</skuidmobile>"),e+="</components><resources><labels/><css/><javascript/></resources></skuidpage>"):"detail-page"===n?(v(),e="Mobile"===u?d+"><models>":d+' showsidebar="true" showheader="true" '+(t?'tabtooverride="'+o+'"':"")+"><models>",e+='<model id="'+h+'" limit="1" query="true" createrowifnonefound="false" datasourcetype="'+p+'" datasource="'+q+'" sobject="'+o+'">',e+="<fields>",c.each(i,function(a,b){s.getField(b)&&(e+='<field id="'+b+'"/>')}),s.getField("CreatedDate")&&(e+='<field id="CreatedDate"/>'),e+="</fields>",e+='<conditions><condition type="param" enclosevalueinquotes="true" operator="=" field="Id" value="id"/></conditions>',e+="</model></models><components>","Desktop"===u?(e+='<pagetitle model="'+h+'"><maintitle><template>',c.each(i,function(a,b){s.getField(b)&&(e+=(0!==a?" ":"")+"{{"+b+"}}")}),e+="</template></maintitle><subtitle><template>{{Model.label}}</template></subtitle><actions>"+(t?'<action type="delete"/><action type="clone"/><action type="share"/>':"")+'<action type="savecancel" window="self"/></actions></pagetitle>',e+='<basicfieldeditor showsavecancel="false" showheader="true" model="'+h+'" mode="read"><columns>',e+='<column width="50%"><sections>',e+='<section title="Basics"><fields>',c.each(i,function(a,b){s.getField(b)&&(e+='<field id="'+b+'"/>')}),e+="</fields></section>",e+="</sections></column>",e+='<column width="50%"><sections>',e+='<section title="System Info"><fields>'+(s.getField("CreatedDate")?'<field id="CreatedDate"/>':"")+"</fields></section>",e+="</sections></column>",e+="</columns></basicfieldeditor>"):"Mobile"===u&&(e+="<skuidmobile>",e+="<mobilepanels>",e+='<mobilepanel uniqueid="main" minwidth="400">',e+="<components>",e+='<mobiledeck showsavecancel="true" searchmethod="server" searchbox="false" tokenizesearch="false" createrecords="false" precision="1" minwidth="200" model="'+h+'" mode="read">',e+="<components>",c.each(i,function(a,b){s.getField(b)&&(e+='<mobilefield id="'+b+'"/>')}),s.getField("CreatedDate")&&(e+='<mobilefield id="CreatedDate"/>'),e+="</components>",e+="<title>{{Model.label}}</title>",e+="<cardtitle>",c.each(i,function(a,b){s.getField(b)&&(e+=(0!==a?" ":"")+"{{"+b+"}}")}),e+="</cardtitle>",e+="</mobiledeck>",e+="</components>",e+="</mobilepanel>",e+="</mobilepanels>",e+="<mobilenavs>",e+='<mobilenav uniqueid="header">',e+="<components>",e+='<mobilegrid precision="6" minwidth="50">',e+="<divisions>",e+='<division size="1">',e+="<components>",e+='<mobilebutton label="" style="nav" icon="fa-bars">',e+="<interactions>",e+='<interaction type="tap">',e+="<actions>",e+='<action type="setMainPanel" panel="main"/>',e+="</actions>",e+="</interaction>",e+="</interactions>",e+="</mobilebutton>",e+="</components>",e+="</division>",e+='<division size="4">',e+="<components>",e+="<mobiletitle>",e+="<contents>{{$Model."+h+".label}}</contents>",e+="</mobiletitle>",e+="</components>",e+="</division>",e+='<division size="1">',e+="<components>",e+='<mobilebutton label="" style="nav" icon="fa-th">',e+="<interactions>",e+='<interaction type="tap">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</interaction>",e+="</interactions>",e+="</mobilebutton>",e+="</components>",e+="</division>",e+="</divisions>",e+="</mobilegrid>",e+="</components>",e+="<interactions>",e+='<interaction type="doubletap">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</interaction>",e+='<interaction type="swipedown">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</interaction>",e+="</interactions>",e+="</mobilenav>",e+="</mobilenavs>",e+="</skuidmobile>"),e+="</components><resources><labels/><css/><javascript/></resources></skuidpage>"):"new-page"===n&&(v(),e="Mobile"===u?d+"><models>":d+' showsidebar="true" showheader="true" '+(t?'tabtooverride="'+o+'"':"")+"><models>",e+='<model id="'+h+'" limit="1" query="false" createrowifnonefound="true" datasourcetype="'+p+'" datasource="'+q+'" sobject="'+o+'">',e+="<fields>",c.each(i,function(a,b){s.getField(b)&&(e+='<field id="'+b+'"/>')}),e+="</fields>",e+="</model></models><components>","Desktop"===u?(e+='<pagetitle model="'+h+'"><maintitle><template>New {{Model.label}}</template></maintitle><subtitle><template>{{Model.labelPlural}}</template></subtitle><actions><action type="savecancel" '+(t?'afterCancel="/{{Model.KeyPrefix}}/o" ':"")+(t?'afterSave="/{{Id}}" ':"")+'rollbackonanyerror="true"/></actions></pagetitle>',e+='<basicfieldeditor showsavecancel="false" showheader="true" model="'+h+'" mode="edit"><columns>',e+='<column width="50%"><sections>',e+='<section title="Basics"><fields>',c.each(i,function(a,b){s.getField(b)&&(e+=(0!==a?" ":"")+'<field id="'+b+'"/>')}),e+="</fields></section>",e+="</sections></column>",e+='<column width="50%"><sections>',e+='<section title="Additional Info"><fields/></section>',e+="</sections></column>",e+="</columns></basicfieldeditor>"):"Mobile"===u&&(e+="<skuidmobile>",e+="<mobilepanels>",e+='<mobilepanel uniqueid="main" minwidth="400">',e+="<components>",e+='<mobiledeck showsavecancel="true" searchmethod="client" searchbox="false" tokenizesearch="false" createrecords="true" precision="1" minwidth="200" model="'+h+'" mode="edit">',e+="<components>",c.each(i,function(a,b){s.getField(b)&&(e+='<mobilefield id="'+b+'"/>')}),e+="</components>",e+="<title>{{Model.label}}</title>",e+="<cardtitle>",c.each(i,function(a,b){s.getField(b)&&(e+=(0!==a?" ":"")+"{{"+b+"}}")}),e+="</cardtitle>",e+="</mobiledeck>",e+="</components>",e+="</mobilepanel>",e+="</mobilepanels>",e+="<mobilenavs>",e+='<mobilenav uniqueid="header">',e+="<components>",e+='<mobilegrid precision="6" minwidth="50">',e+="<divisions>",e+='<division size="1">',e+="<components>",e+='<mobilebutton label="" style="nav" icon="fa-bars">',e+="<interactions>",e+='<interaction type="tap">',e+="<actions>",e+='<action type="setMainPanel" panel="main"/>',e+="</actions>",e+="</interaction>",e+="</interactions>",e+="</mobilebutton>",e+="</components>",e+="</division>",e+='<division size="4">',e+="<components>",e+="<mobiletitle>",e+="<contents>New {{$Model."+h+".label}}</contents>",e+="</mobiletitle>",e+="</components>",e+="</division>",e+='<division size="1">',e+="<components>",e+='<mobilebutton label="" style="nav" icon="fa-th">',e+="<interactions>",e+='<interaction type="tap">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</interaction>",e+="</interactions>",e+="</mobilebutton>",e+="</components>",e+="</division>",e+="</divisions>",e+="</mobilegrid>",e+="</components>",e+="<interactions>",e+='<interaction type="doubletap">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</interaction>",e+='<interaction type="swipedown">',e+="<actions>",e+='<action type="toggleSetupMenu"/>',e+="</actions>",e+="</interaction>",e+="</interactions>",e+="</mobilenav>",e+="</mobilenavs>",e+="</skuidmobile>"),e+="</components><resources><labels/><css/><javascript/></resources></skuidpage>");else if("masterpage"===m)e='<skuidpage unsavedchangeswarning="yes" useviewportmeta="true"><models/><pageregioncontents/><components/><resources><labels/><css/><javascript/></resources></skuidpage>';else if("from-xml"===m){var w=k.getFieldValue(l,"skuid__Page_XML__c",!0);return void(w&&f.writeXmlToPageLayoutFields(w,k,l))}e||(e="Mobile"===u?d+"><models/><components><skuidmobile><mobilepanels/><mobilenavs/></skuidmobile></components><resources><labels/><javascript/><css/></resources></skuidpage>":d+' showsidebar="true" showheader="true"><models/><components/><resources><labels/><javascript/><css/></resources></skuidpage>'),f.writeXmlToPageLayoutFields(e,k,l)};if(e("skuid.pageList.buildLayoutFromTemplate",function(){h({model:b,row:arguments[0].row})}),f._ie<9&&c(".sk-header-skuidlogo img").attr("src",a.utils.getStaticResourceUrl("SkuidLogoCustomHeaderPNG","skuid",undefined,a.version.date)),f._ie<10){c(".nx-page").addClass("sk-ie-legacy");var i=c(".sk-master-grid-division-rightside");i.eq(0).prev().after(i.toArray().reverse())}})}(skuid);