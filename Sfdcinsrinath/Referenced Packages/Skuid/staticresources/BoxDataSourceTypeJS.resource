"use strict";!function(a){var b=a.$,c=a.dataSource,d=a.constants,e=d.DISPLAY_TYPES,f=d.MIME_TYPES,g=d.HTTP_VERBS,h=c.utils,i=a.utils,j=i.getObjectProperty,k=i.capitalizeFirst,l=f.JSON,m=e.STRING,n=e.INTEGER,o=e.DATETIME,p=g.GET,q=function(a){return a.dataSource.authentication.responseBody.access_token},r=function(c,d,e,f,g){var h=new FormData,i=c.name,j=e.model,k=a.dataSource.utils.getModelMergeConditions(j,{model:j,row:e.row}),l=k.folderid;f({fileName:e.filename||i}),h.append("file",c),h.append("parent_id",l),b.ajax({url:"https://upload.box.com/api/2.0/files/content",headers:{Authorization:"Bearer "+q(j)},type:"POST",processData:!1,contentType:!1,data:h,success:function(){g()},error:function(a){g({message:a.responseText||"Had an Error!"})}})},s=function(a){var b=h.getModelMergeConditions(a.model,a),c=b.folderid,d=b.__default_searchbox,e=a.request.url;c&&(e=e.replace("{{folderid}}",c)),d&&(e="/search?query="+d),a.request.url=e};c.getDataSourceType("Box")||new c.core.RESTDataSourceTypeBase({name:"Box",coerceRequest:function(a){"query"===a.type&&(a.row&&"Folder"===a.row.type&&(a.request.url="/folders/{{id}}"),s(a))},getEntityList:h.getEntityListStatic,queryEntityMetadata:function(a){var c=this.getEntityMetadataCacheKey(a),d=this.prop("x-metadata")[c];return b.Deferred().resolve(d)},parseSuccessfulLoadResponse:function(a,c,d,e){var f=this,g=f.parseResponseBodyAsJSON(a.body),h=c.pathToContent,i=h?j(g,h):g,l=f.getIdField(e);d.data=i,b.isArray(i)&&b.each(i,function(a,b){b.Id=b[l],b.type=k(j(b,"type"))})},getUploadMethods:function(){return{"Direct Upload":{label:"Direct Upload",canRunPostUploadSnippet:!0,upload:r,needsModelInContext:!0,hasDescription:!1,hasName:!1}}},extendedProperties:{hasDefaultSearch:!0,canServerSearch:!0,"x-metadata":{File:{label:"File",labelPlural:"Files",fields:[{id:"id",label:"Id",inlineHelpText:"The ID of the file or folder",idField:!0,displaytype:m,"x-alwaysinclude":!0},{id:"type",label:"Type",inlineHelpText:"The type of the item",displaytype:m},{id:"name",label:"Name",inlineHelpText:"The name of the file or folder",displaytype:m},{id:"etag",label:"Etag",inlineHelpText:"A unique string identifying the version",displaytype:m},{id:"description",label:"Description",inlineHelpText:"The description of this item",displaytype:m,defer:!0,path:"description"},{id:"size",label:"Size (in bytes)",inlineHelpText:"Size of this file in bytes",displaytype:n,defer:!0,path:"size"},{id:"created_at",label:"Created At",inlineHelpText:"When this file was created",displaytype:o,defer:!0,path:"created_at"},{id:"modified_at",label:"Modified At",inlineHelpText:"When this file was last updated",displaytype:o,defer:!0,path:"modified_at"},{id:"content_created_at",label:"Content Created",inlineHelpText:"When the content of this file was created",displaytype:o,defer:!0,path:"content_created_at"},{id:"content_modified_at",label:"Content Modified",inlineHelpText:"When the content of this file was modified",displaytype:o,defer:!0,path:"content_modified_at"},{id:"created_by",label:"Created By",inlineHelpText:"The user who first created this file",displaytype:m,defer:!0,path:"created_by.name"},{id:"owned_by",label:"Owned By",inlineHelpText:"The user who owns this file",displaytype:m,defer:!0,path:"owned_by.name"},{id:"modified_by",label:"Modified By",inlineHelpText:"The user who last updated this file",displaytype:m,defer:!0,path:"modified_by.name"},{id:"shared_link",label:"Shared Link",inlineHelpText:"The shared link for this file",displaytype:m,defer:!0,path:"shared_link.url"},{id:"parent",label:"Parent",inlineHelpText:"The folder containing this file",displaytype:m,defer:!0,path:"parent.name"},{id:"item_status",label:"Status",inlineHelpText:"Whether this item is deleted or not",displaytype:m,defer:!0,path:"item_status"}],methods:{query:{url:"/folders/{{folderid}}/items",verb:p,contentType:l,pathToContent:"entries",additionalRequests:function(){return[{url:"/files/{{id}}",verb:p,contentType:l,fields:["description","size","created_at","modified_at","content_created_at","content_modified_at","created_by","modified_by","owned_by","shared_link","parent","item_status"]}]}()}},defaultConditions:[{sourcetype:"param",sourceparam:"folderid",name:"Folder",label:"Folder",state:"filterableon",value:"0"}]}}}})}(skuid);